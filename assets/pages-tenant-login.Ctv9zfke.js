import{d as e,r as l,I as s,c as a,w as o,i as t,b as n,e as u,f as c,m as i,n as r,g as d,q as f,G as p,K as m,t as _,y as v,s as g,h as y,a as h,W as k,v as w,u as x,Z as b}from"./index-BWYHzEly.js";import{_ as C}from"./tenant-logo.B_ubGxOA.js";import{b as z}from"./request.DW5hqJBG.js";import{_ as V}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=V(e({__name:"login",setup(e){const V=l(""),I=l(""),j=l(!1),F=l(!1),M=l(""),q=s({username:!1,password:!1}),B=()=>{j.value=!j.value},T=async()=>{if(V.value&&I.value)try{F.value=!0,M.value="",g({title:"登录中..."});const l={username:V.value,password:I.value,role:"tenant"};try{const e=await z("/auth/login/password",l);e&&e.success?(y(),h({title:"登录成功",icon:"success"}),e.token&&k("token",e.token),e.user&&k("userInfo",e.user),w({url:"/pages/tenant/home",success(){console.log("成功跳转到租户主页")},fail(e){console.error("跳转失败:",e),h({title:"跳转失败: "+e.errMsg,icon:"none"})}})):(y(),M.value=(null==e?void 0:e.message)||"用户名或密码错误",h({title:M.value,icon:"none"}))}catch(e){if(console.error("API请求失败:",e),y(),"demo"===V.value&&"demo123"===I.value){const e={id:"tenant-001",username:V.value,role:"tenant",name:"测试租户"};k("userInfo",e),k("token","mock-token-123456"),h({title:"(模拟)登录成功",icon:"success"}),setTimeout((()=>{w({url:"/pages/tenant/home",success(){console.log("成功跳转到租户主页(模拟)")},fail(e){console.error("跳转失败(模拟):",e),h({title:"跳转失败: "+e.errMsg,icon:"none"})}})}),1500)}else M.value="服务器连接失败，请检查网络",h({title:M.value,icon:"none"})}}finally{F.value=!1,setTimeout((()=>{y()}),500)}else M.value="请输入用户名和密码"},U=()=>{x({url:"/pages/tenant/register"})},A=()=>{h({title:"忘记密码功能开发中",icon:"none"})},G=e=>{h({title:("wechat"===e?"微信":"手机号")+"登录功能开发中",icon:"none"})},K=()=>{b({url:"/pages/index/index",success(){console.log("成功跳转到首页")},fail(e){console.error("跳转失败:",e),h({title:"跳转失败: "+e.errMsg,icon:"none"})}})};return(e,l)=>{const s=i,g=r,y=t,h=n("uni-icons"),k=m,w=v;return u(),a(y,{class:"tenant-login-page"},{default:o((()=>[c(y,{class:"login-header"},{default:o((()=>[c(s,{src:C,mode:"aspectFit",class:"logo"}),c(y,{class:"header-text"},{default:o((()=>[c(g,{class:"welcome-text"},{default:o((()=>[d("欢迎回来")])),_:1}),c(g,{class:"subtitle"},{default:o((()=>[d("登录您的租户账号")])),_:1})])),_:1})])),_:1}),c(y,{class:"login-container"},{default:o((()=>[c(y,{class:"form-group"},{default:o((()=>[c(y,{class:p(["form-item",{active:q.username}])},{default:o((()=>[c(h,{type:"person",size:"22",color:"#ff2442"}),c(k,{type:"text",modelValue:V.value,"onUpdate:modelValue":l[0]||(l[0]=e=>V.value=e),placeholder:"用户名/手机号",class:"input",onFocus:l[1]||(l[1]=e=>q.username=!0),onBlur:l[2]||(l[2]=e=>q.username=!1),focus:""},null,8,["modelValue"])])),_:1},8,["class"]),c(y,{class:p(["form-item",{active:q.password}])},{default:o((()=>[c(h,{type:"locked",size:"22",color:"#ff2442"}),c(k,{type:j.value?"text":"password",modelValue:I.value,"onUpdate:modelValue":l[3]||(l[3]=e=>I.value=e),placeholder:"请输入密码",class:"input",onFocus:l[4]||(l[4]=e=>q.password=!0),onBlur:l[5]||(l[5]=e=>q.password=!1)},null,8,["type","modelValue"]),c(y,{class:"password-toggle",onClick:B},{default:o((()=>[c(h,{type:j.value?"eye-filled":"eye-slash-filled",size:"20",color:"#909399"},null,8,["type"])])),_:1})])),_:1},8,["class"])])),_:1}),M.value?(u(),a(y,{key:0,class:"error-message"},{default:o((()=>[c(h,{type:"info-filled",size:"14",color:"#ff2442"}),c(g,null,{default:o((()=>[d(_(M.value),1)])),_:1})])),_:1})):f("",!0),c(w,{class:p(["login-button",{loading:F.value}]),onClick:T,disabled:F.value},{default:o((()=>[c(y,{class:"button-content"},{default:o((()=>[F.value?(u(),a(y,{key:0,class:"loading-spinner"})):f("",!0),c(g,null,{default:o((()=>[d(_(F.value?"登录中...":"登录"),1)])),_:1})])),_:1})])),_:1},8,["disabled","class"]),c(w,{class:"back-home-button",onClick:K},{default:o((()=>[d(" 返回首页 ")])),_:1}),c(y,{class:"extra-links"},{default:o((()=>[c(g,{onClick:A},{default:o((()=>[d("忘记密码?")])),_:1}),c(g,{onClick:U},{default:o((()=>[d("注册新账号")])),_:1})])),_:1})])),_:1}),c(y,{class:"login-options"},{default:o((()=>[c(y,{class:"divider"},{default:o((()=>[c(y,{class:"line"}),c(g,null,{default:o((()=>[d("其他登录方式")])),_:1}),c(y,{class:"line"})])),_:1}),c(y,{class:"social-login"},{default:o((()=>[c(y,{class:"social-icon wechat",onClick:l[6]||(l[6]=e=>G("wechat"))},{default:o((()=>[c(h,{type:"weixin",size:"30",color:"#fff"})])),_:1}),c(y,{class:"social-icon phone",onClick:l[7]||(l[7]=e=>G("phone"))},{default:o((()=>[c(h,{type:"phone",size:"26",color:"#fff"})])),_:1})])),_:1})])),_:1}),c(y,{class:"footer"},{default:o((()=>[c(g,null,{default:o((()=>[d("登录即代表您同意")])),_:1}),c(g,{class:"terms"},{default:o((()=>[d("《用户协议》")])),_:1}),c(g,null,{default:o((()=>[d("和")])),_:1}),c(g,{class:"terms"},{default:o((()=>[d("《隐私政策》")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-850308cb"]]);export{I as default};
