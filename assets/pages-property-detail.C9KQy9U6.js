import{d as e,r as a,x as l,a as s,c as t,w as u,i,e as o,f as c,q as r,p as n,n as d,g as f,t as p,y as _,S as v,j as m,F as y,k as g,l as b,m as k,u as h}from"./index-BWYHzEly.js";import{g as j}from"./request.DW5hqJBG.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";const q=I(e({__name:"detail",setup(e){const I=a(null),q=a(!0),w=a(null),x=a(""),C=async e=>{q.value=!0,x.value="",I.value=null;try{const a=await j(`/properties/${e}`);a&&a.success&&a.property?I.value=a.property:a&&"object"==typeof a&&a.id?I.value=a:a&&a.data&&"object"==typeof a.data?I.value=a.data:(x.value="房源数据格式错误",console.error("无法识别的API响应格式:",a),s({title:"数据格式错误",icon:"none"}))}catch(a){x.value="获取房源信息失败",console.error("获取房源详情失败:",a),s({title:"网络错误，请稍后重试",icon:"none"})}finally{q.value=!1}},F=()=>{w.value&&C(w.value)};l((e=>{(null==e?void 0:e.id)?(w.value=e.id,C(e.id)):(console.error("Property ID is missing"),q.value=!1,x.value="缺少房源ID",s({title:"无法加载房源信息",icon:"error"}))}));const $=()=>{I.value&&h({url:`/pages/inquiry/chat?propertyId=${I.value.id}`})},D=()=>{I.value&&h({url:`/pages/booking/form?propertyId=${I.value.id}`})};return(e,a)=>{const l=i,s=d,h=_,j=k,w=b,C=v,P=n;return o(),t(l,{class:"property-detail-page"},{default:u((()=>[c(P,{"scroll-y":"",class:"scroll-container"},{default:u((()=>[q.value?(o(),t(l,{key:0,class:"loading-placeholder"},{default:u((()=>[c(l,{class:"loading-icon"}),c(s,null,{default:u((()=>[f("加载中...")])),_:1})])),_:1})):x.value?(o(),t(l,{key:1,class:"error-placeholder"},{default:u((()=>[c(s,null,{default:u((()=>[f(p(x.value),1)])),_:1}),c(h,{class:"retry-button",onClick:F},{default:u((()=>[f("重试")])),_:1})])),_:1})):I.value?(o(),t(l,{key:3,class:"content"},{default:u((()=>[c(C,{class:"image-swiper","indicator-dots":"",autoplay:"",circular:""},{default:u((()=>[(o(!0),m(y,null,g(I.value.images,((e,a)=>(o(),t(w,{key:a},{default:u((()=>[c(j,{class:"swiper-image",src:e,mode:"aspectFill"},null,8,["src"])])),_:2},1024)))),128)),I.value.images&&0!==I.value.images.length?r("",!0):(o(),t(w,{key:0},{default:u((()=>[c(j,{class:"swiper-image",src:"./static/default-property.png",mode:"aspectFill"})])),_:1}))])),_:1}),c(l,{class:"section basic-info"},{default:u((()=>[c(l,{class:"title"},{default:u((()=>[f(p(I.value.title),1)])),_:1}),c(l,{class:"price"},{default:u((()=>[f("￥"+p(I.value.price_per_month)+"/月",1)])),_:1}),c(l,{class:"tags"},{default:u((()=>[c(s,{class:"tag"},{default:u((()=>[f(p(I.value.property_type),1)])),_:1}),c(s,{class:"tag"},{default:u((()=>[f(p(I.value.bedrooms)+"室"+p(I.value.bathrooms)+"卫",1)])),_:1}),c(s,{class:"tag"},{default:u((()=>[f(p(I.value.area_sqm)+"㎡",1)])),_:1})])),_:1})])),_:1}),c(l,{class:"section detail-info"},{default:u((()=>[c(l,{class:"section-title"},{default:u((()=>[f("房源信息")])),_:1}),c(l,{class:"info-item"},{default:u((()=>[c(s,{class:"label"},{default:u((()=>[f("地址:")])),_:1}),c(s,{class:"value"},{default:u((()=>[f(p(I.value.city)+" "+p(I.value.district)+" "+p(I.value.address),1)])),_:1})])),_:1})])),_:1}),c(l,{class:"section amenities-info"},{default:u((()=>[c(l,{class:"section-title"},{default:u((()=>[f("配套设施")])),_:1}),c(l,{class:"amenities-grid"},{default:u((()=>[(o(!0),m(y,null,g(I.value.amenities,(e=>(o(),t(l,{key:e,class:"amenity-item"},{default:u((()=>[c(s,null,{default:u((()=>[f(p(e),1)])),_:2},1024)])),_:2},1024)))),128)),I.value.amenities&&0!==I.value.amenities.length?r("",!0):(o(),t(l,{key:0},{default:u((()=>[f("暂无设施信息")])),_:1}))])),_:1})])),_:1}),c(l,{class:"section description-info"},{default:u((()=>[c(l,{class:"section-title"},{default:u((()=>[f("房源描述")])),_:1}),c(s,{class:"description-text"},{default:u((()=>[f(p(I.value.description||"暂无详细描述"),1)])),_:1})])),_:1})])),_:1})):(o(),t(l,{key:2,class:"error-placeholder"},{default:u((()=>[f("房源信息加载失败")])),_:1}))])),_:1}),I.value?(o(),t(l,{key:0,class:"bottom-bar"},{default:u((()=>[c(h,{class:"action-button inquiry-button",onClick:$},{default:u((()=>[f("智能咨询")])),_:1}),c(h,{class:"action-button book-button",onClick:D},{default:u((()=>[f("预约看房")])),_:1})])),_:1})):r("",!0)])),_:1})}}}),[["__scopeId","data-v-05ce73f5"]]);export{q as default};
