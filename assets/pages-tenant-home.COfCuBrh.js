import{d as e,I as t,r as a,H as s,o as l,c as n,w as c,s as u,z as i,h as o,a as r,u as d,i as f,b as _,e as m,f as p,m as g,n as y,g as v,t as k,q as b,j as h,F as C,k as w,_ as D,G as I,y as F}from"./index-BWYHzEly.js";import{g as x}from"./request.DW5hqJBG.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const z=j(e({__name:"home",setup(e){const j=t({id:"",username:"",name:"",avatar:"",role:"tenant"}),z=a(2),A=t([{title:"找房源",icon:"search",url:"/pages/tenant/house-list",bgColor:"#4CD964"},{title:"申请维修",icon:"wrench",url:"/pages/tenant/maintenance-create",bgColor:"#007AFF"},{title:"缴纳账单",icon:"wallet",url:"/pages/tenant/bills",bgColor:"#FF9500"},{title:"我的合同",icon:"file-text",url:"/pages/tenant/contracts",bgColor:"#5856D6"}]),S=a(null),$=s((()=>{if(!S.value)return"";switch(S.value.status){case"active":return"status-active";case"pending":return"status-pending";case"expired":return"status-expired";default:return""}})),q=s((()=>{if(!S.value)return"";switch(S.value.status){case"active":return"租约生效中";case"pending":return"待生效";case"expired":return"已到期";default:return"未知状态"}})),T=t({rentAmount:null,rentDueDate:null,rentStatus:null,utilityAmount:null,utilityDueDate:null,utilityStatus:null}),O=a([]),G=a([]),H=e=>{switch(e){case"pending":return"待处理";case"processing":return"处理中";case"completed":return"已完成";case"rejected":return"已拒绝";default:return"未知状态"}},R=e=>{d({url:e})},B=()=>{R("/pages/tenant/notifications")},E=()=>{R("/pages/tenant/settings")},J=()=>{r({title:"租金支付功能开发中",icon:"none"})},K=()=>{r({title:"水电费支付功能开发中",icon:"none"})};return l((()=>{(async()=>{try{u({title:"加载数据中..."});const t=i("userInfo"),a=i("userId");if(t)Object.assign(j,t);else{if(!a)return o(),r({title:"请先登录",icon:"none",duration:2e3}),void setTimeout((()=>{d({url:"/pages/tenant/login"})}),1500);j.id=a}try{const e=j.id||i("userId");if(!e)return console.error("未找到用户ID，无法获取租房信息"),void r({title:"请先登录",icon:"none"});const t=await x(`/tenant/rental/current?userId=${e}`);console.log("租房信息接口返回:",t),(t&&t.success&&t.data||t&&t.data)&&(S.value=t.data)}catch(e){console.error("获取租房信息失败:",e)}try{const e=j.id||i("userId");if(!e)return void console.error("未找到用户ID，无法获取账单信息");const t=await x(`/tenant/bills/summary?userId=${e}`);console.log("账单信息接口返回:",t),(t&&t.success&&t.data||t&&t.data)&&Object.assign(T,t.data)}catch(e){console.error("获取账单信息失败:",e)}try{const e=j.id||i("userId");if(!e)return void console.error("未找到用户ID，无法获取维修请求");const t=await x(`/tenant/maintenance/recent?userId=${e}`);console.log("维修请求接口返回:",t),(t&&t.success&&t.data||t&&t.data)&&(O.value=t.data)}catch(e){console.error("获取维修请求失败:",e)}try{const e=j.id||i("userId");if(!e)return void console.error("未找到用户ID，无法获取公告");const t=await x(`/tenant/announcements/recent?userId=${e}`);console.log("公告接口返回:",t),(t&&t.success&&t.data||t&&t.data)&&(G.value=t.data)}catch(e){console.error("获取公告失败:",e)}o()}catch(t){o(),console.error("加载数据失败:",t),r({title:"加载数据失败",icon:"none"})}})()})),(e,t)=>{const a=g,s=y,l=f,u=_("uni-icons"),i=F;return m(),n(l,{class:"tenant-home"},{default:c((()=>[p(l,{class:"header"},{default:c((()=>[p(l,{class:"user-info"},{default:c((()=>[p(a,{class:"avatar",src:j.avatar||"/static/default-avatar.png",mode:"aspectFill"},null,8,["src"]),p(l,{class:"user-details"},{default:c((()=>[p(s,{class:"username"},{default:c((()=>[v(k(j.name||j.username||"租户用户"),1)])),_:1}),p(s,{class:"user-role"},{default:c((()=>[v("租户账号")])),_:1})])),_:1})])),_:1}),p(l,{class:"header-actions"},{default:c((()=>[p(l,{class:"notification",onClick:B},{default:c((()=>[p(u,{type:"notification-filled",size:"24",color:"#333"}),z.value>0?(m(),n(l,{key:0,class:"badge"},{default:c((()=>[v(k(z.value>99?"99+":z.value),1)])),_:1})):b("",!0)])),_:1}),p(l,{class:"settings",onClick:E},{default:c((()=>[p(u,{type:"gear-filled",size:"24",color:"#333"})])),_:1})])),_:1})])),_:1}),p(l,{class:"quick-actions"},{default:c((()=>[(m(!0),h(C,null,w(A,((e,t)=>(m(),n(l,{class:"action-card",key:t,onClick:t=>R(e.url)},{default:c((()=>[p(l,{class:"action-icon",style:D({backgroundColor:e.bgColor})},{default:c((()=>[p(u,{type:e.icon,size:"24",color:"#fff"},null,8,["type"])])),_:2},1032,["style"]),p(s,{class:"action-title"},{default:c((()=>[v(k(e.title),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),p(l,{class:"section rental-info"},{default:c((()=>[p(l,{class:"section-header"},{default:c((()=>[p(s,{class:"section-title"},{default:c((()=>[v("我的租房")])),_:1}),p(s,{class:"view-more",onClick:t[0]||(t[0]=e=>R("/pages/tenant/rentals"))},{default:c((()=>[v("查看全部")])),_:1})])),_:1}),S.value?(m(),n(l,{key:0,class:"current-rental"},{default:c((()=>[p(a,{class:"rental-image",src:S.value.coverImage||"/static/default-house.jpg",mode:"aspectFill"},null,8,["src"]),p(l,{class:"rental-details"},{default:c((()=>[p(l,{class:"rental-name"},{default:c((()=>[v(k(S.value.name),1)])),_:1}),p(l,{class:"rental-address"},{default:c((()=>[v(k(S.value.address),1)])),_:1}),p(l,{class:"rental-info-row"},{default:c((()=>[p(s,{class:"info-label"},{default:c((()=>[v("租期:")])),_:1}),p(s,{class:"info-value"},{default:c((()=>[v(k(S.value.startDate)+" 至 "+k(S.value.endDate),1)])),_:1})])),_:1}),p(l,{class:"rental-info-row"},{default:c((()=>[p(s,{class:"info-label"},{default:c((()=>[v("月租:")])),_:1}),p(s,{class:"info-value price"},{default:c((()=>[v("¥"+k(S.value.monthlyRent),1)])),_:1})])),_:1}),p(l,{class:I(["rental-status",$.value])},{default:c((()=>[v(k(q.value),1)])),_:1},8,["class"])])),_:1})])),_:1})):(m(),n(l,{key:1,class:"empty-rental"},{default:c((()=>[p(a,{src:"./static/empty-house.png",mode:"aspectFit",class:"empty-image"}),p(s,{class:"empty-text"},{default:c((()=>[v("您暂时没有租房记录")])),_:1}),p(i,{class:"search-button",onClick:t[1]||(t[1]=e=>R("/pages/tenant/house-list"))},{default:c((()=>[v(" 寻找房源 ")])),_:1})])),_:1}))])),_:1}),p(l,{class:"section bills"},{default:c((()=>[p(l,{class:"section-header"},{default:c((()=>[p(s,{class:"section-title"},{default:c((()=>[v("账单概览")])),_:1}),p(s,{class:"view-more",onClick:t[2]||(t[2]=e=>R("/pages/tenant/bills"))},{default:c((()=>[v("账单管理")])),_:1})])),_:1}),p(l,{class:"bill-cards"},{default:c((()=>[p(l,{class:"bill-card rent"},{default:c((()=>[p(l,{class:"bill-title"},{default:c((()=>[p(u,{type:"home",size:"18",color:"#4CD964"}),p(s,null,{default:c((()=>[v("本月租金")])),_:1})])),_:1}),p(l,{class:"bill-amount"},{default:c((()=>[v("¥"+k(T.rentAmount||"--"),1)])),_:1}),p(l,{class:"bill-due-date"},{default:c((()=>[p(s,null,{default:c((()=>[v("到期日: "+k(T.rentDueDate||"--"),1)])),_:1}),"unpaid"===T.rentStatus?(m(),n(i,{key:0,class:"pay-button",onClick:J},{default:c((()=>[v(" 立即支付 ")])),_:1})):"paid"===T.rentStatus?(m(),n(s,{key:1,class:"paid-status"},{default:c((()=>[v("已支付")])),_:1})):b("",!0)])),_:1})])),_:1}),p(l,{class:"bill-card utilities"},{default:c((()=>[p(l,{class:"bill-title"},{default:c((()=>[p(u,{type:"notification",size:"18",color:"#007AFF"}),p(s,null,{default:c((()=>[v("水电气费")])),_:1})])),_:1}),p(l,{class:"bill-amount"},{default:c((()=>[v("¥"+k(T.utilityAmount||"--"),1)])),_:1}),p(l,{class:"bill-due-date"},{default:c((()=>[p(s,null,{default:c((()=>[v("到期日: "+k(T.utilityDueDate||"--"),1)])),_:1}),"unpaid"===T.utilityStatus?(m(),n(i,{key:0,class:"pay-button",onClick:K},{default:c((()=>[v(" 立即支付 ")])),_:1})):"paid"===T.utilityStatus?(m(),n(s,{key:1,class:"paid-status"},{default:c((()=>[v("已支付")])),_:1})):b("",!0)])),_:1})])),_:1})])),_:1})])),_:1}),p(l,{class:"section maintenance"},{default:c((()=>[p(l,{class:"section-header"},{default:c((()=>[p(s,{class:"section-title"},{default:c((()=>[v("维修申请")])),_:1}),p(s,{class:"view-more",onClick:t[3]||(t[3]=e=>R("/pages/tenant/maintenance"))},{default:c((()=>[v("查看全部")])),_:1})])),_:1}),O.value.length>0?(m(),n(l,{key:0,class:"maintenance-list"},{default:c((()=>[(m(!0),h(C,null,w(O.value,((e,t)=>(m(),n(l,{class:"maintenance-item",key:t,onClick:t=>R(`/pages/tenant/maintenance-detail?id=${e.id}`)},{default:c((()=>[p(l,{class:I(["maintenance-status","status-"+e.status])},{default:c((()=>[v(k(H(e.status)),1)])),_:2},1032,["class"]),p(l,{class:"maintenance-title"},{default:c((()=>[v(k(e.title),1)])),_:2},1024),p(l,{class:"maintenance-date"},{default:c((()=>[v("申请时间: "+k(e.createTime),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):(m(),n(l,{key:1,class:"empty-maintenance"},{default:c((()=>[p(a,{src:"./static/empty-maintenance.png",mode:"aspectFit",class:"empty-image"}),p(s,{class:"empty-text"},{default:c((()=>[v("暂无维修申请")])),_:1}),p(i,{class:"request-button",onClick:t[4]||(t[4]=e=>R("/pages/tenant/maintenance-create"))},{default:c((()=>[v(" 申请维修 ")])),_:1})])),_:1}))])),_:1}),p(l,{class:"section announcements"},{default:c((()=>[p(l,{class:"section-header"},{default:c((()=>[p(s,{class:"section-title"},{default:c((()=>[v("最新公告(未开发)")])),_:1}),p(s,{class:"view-more",onClick:t[5]||(t[5]=e=>R("/pages/tenant/announcements"))},{default:c((()=>[v("全部公告")])),_:1})])),_:1}),G.value.length>0?(m(),n(l,{key:0,class:"announcement-list"},{default:c((()=>[(m(!0),h(C,null,w(G.value,((e,t)=>(m(),n(l,{class:"announcement-item",key:t,onClick:t=>R(`/pages/tenant/announcement-detail?id=${e.id}`)},{default:c((()=>[p(l,{class:"announcement-content"},{default:c((()=>[p(s,{class:"announcement-title"},{default:c((()=>[v(k(e.title),1)])),_:2},1024),p(s,{class:"announcement-preview"},{default:c((()=>[v(k(e.content),1)])),_:2},1024)])),_:2},1024),p(s,{class:"announcement-time"},{default:c((()=>[v(k(e.createTime),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):(m(),n(l,{key:1,class:"empty-announcements"},{default:c((()=>[p(a,{src:"./static/empty-notice.png",mode:"aspectFit",class:"empty-image"}),p(s,{class:"empty-text"},{default:c((()=>[v("暂无公告信息")])),_:1})])),_:1}))])),_:1})])),_:1})}}}),[["__scopeId","data-v-984cd797"]]);export{z as default};
