import{d as e,r as a,x as s,c as t,w as l,Y as u,i,e as n,f as o,p as r,j as d,q as c,g as m,t as v,F as p,k as f,G as g,m as _,n as y,K as h,y as w}from"./index-BWYHzEly.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=b(e({__name:"chat",setup(e){const b=a([]),x=a(""),I=a(!1),k=a(""),$=a(null),D=a(null),j=()=>{u((()=>{k.value="",setTimeout((()=>{k.value="bottom-anchor"}),100)}))},q=async()=>{var e;const a=x.value.trim();if(!a||I.value)return;b.value.push({sender:"user",text:a,timestamp:Date.now()}),x.value="",j(),I.value=!0;const s=b.value.slice(-5);console.log("Sending to AI:",{question:a,propertyId:$.value,history:s}),await new Promise((e=>setTimeout(e,1500)));const t=`关于"${a}"，我的回答是：这是模拟的AI回复。如果您咨询的是房源 ${(null==(e=D.value)?void 0:e.title)||""}, 它的特点是...`;b.value.push({sender:"ai",text:t,timestamp:Date.now()}),I.value=!1,j()};return s((e=>{var a;(null==e?void 0:e.propertyId)?($.value=e.propertyId,(async e=>{console.log(`Fetching brief info for property ID: ${e}`),await new Promise((e=>setTimeout(e,300))),D.value={id:e,title:`模拟房源 ${e.split("_")[1]}`}})(e.propertyId),b.value.push({sender:"ai",text:`您好！很高兴为您服务。您可以问我关于房源 ${(null==(a=D.value)?void 0:a.title)||""} 的任何问题。`,timestamp:Date.now()})):b.value.push({sender:"ai",text:"您好！很高兴为您服务。您可以问我关于房源的任何问题。",timestamp:Date.now()}),j()})),(e,a)=>{const s=i,u=_,$=y,j=r,T=h,V=w;return n(),t(s,{class:"inquiry-chat-page"},{default:l((()=>[o(j,{"scroll-y":"",class:"message-list","scroll-into-view":k.value,"scroll-with-animation":""},{default:l((()=>[D.value?(n(),t(s,{key:0,class:"tips"},{default:l((()=>[m(' 正在咨询关于 "'+v(D.value.title)+'" 的信息 ',1)])),_:1})):(n(),t(s,{key:1,class:"tips"},{default:l((()=>[m(" 您可以咨询关于房源的任何问题 ")])),_:1})),(n(!0),d(p,null,f(b.value,((e,a)=>(n(),t(s,{key:a,id:`msg-${a}`},{default:l((()=>[o(s,{class:g(["message-item","user"===e.sender?"user-message":"ai-message"])},{default:l((()=>[o(u,{class:"avatar",src:"user"===e.sender?"/static/user-avatar.png":"/static/ai-avatar.png"},null,8,["src"]),o(s,{class:"message-content"},{default:l((()=>[o($,{selectable:""},{default:l((()=>[m(v(e.text),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1032,["id"])))),128)),I.value?(n(),t(s,{key:2,class:"message-item ai-message loading-message"},{default:l((()=>[o(u,{class:"avatar",src:"./static/ai-avatar.png"}),o(s,{class:"message-content"},{default:l((()=>[o($,null,{default:l((()=>[m("思考中...")])),_:1})])),_:1})])),_:1})):c("",!0),o(s,{id:"bottom-anchor"})])),_:1},8,["scroll-into-view"]),o(s,{class:"input-area"},{default:l((()=>[o(T,{class:"input-field",modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value=e),placeholder:"请输入您的问题...","confirm-type":"send",onConfirm:q,disabled:I.value},null,8,["modelValue","disabled"]),o(V,{class:"send-button",onClick:q,disabled:!x.value.trim()||I.value},{default:l((()=>[m(" 发送 ")])),_:1},8,["disabled"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-703ce6be"]]);export{x as default};
