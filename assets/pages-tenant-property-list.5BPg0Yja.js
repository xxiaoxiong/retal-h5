import{d as e,r as a,o as l,c as t,w as s,a as r,i as o,e as u,f as i,K as n,y as p,g as c,p as d,j as v,q as y,F as f,k as _,m,t as g,n as h,u as k}from"./index-BWYHzEly.js";import{g as w}from"./request.DW5hqJBG.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=A(e({__name:"property-list",setup(e){const A=a([]),j=a(!1),C=a(!1),q=a(!0),x=a(1),S=a({}),F=async(e=1,a={})=>{1===e?(j.value=!0,A.value=[]):C.value=!0;try{const l={page:e,limit:10,...a},t=await w("/properties",l);let s=[],o=0;t&&t.success&&t.properties?(s=t.properties,o=t.total||0,q.value=s.length<o):t&&Array.isArray(t)?(s=t,q.value=t.length>=10):t&&t.data&&Array.isArray(t.data)?(s=t.data,q.value=t.data.length>=10):(console.error("无法识别的API响应格式:",t),r({title:"数据格式不正确",icon:"none"})),A.value=1===e?s:[...A.value,...s]}catch(l){console.error("获取房源数据失败:",l),r({title:"网络错误，请稍后重试",icon:"none"})}finally{1===e?j.value=!1:C.value=!1}},I=()=>{q.value&&!C.value&&(x.value++,F(x.value,S.value))},b=e=>{const a=e.detail.value;console.log("Search keyword:",a),S.value={...S.value,keyword:a},x.value=1,F(x.value,S.value)},z=()=>{console.log("Show filter popup"),r({title:"筛选功能待实现",icon:"none"})};return l((()=>{F(x.value,S.value)})),(e,a)=>{const l=n,r=p,w=o,x=m,S=h,F=d;return u(),t(w,{class:"property-list-page"},{default:s((()=>[i(w,{class:"filter-section"},{default:s((()=>[i(l,{class:"search-input",placeholder:"搜索区域、小区名",onConfirm:b}),i(r,{size:"mini",onClick:z},{default:s((()=>[c("筛选")])),_:1})])),_:1}),i(F,{"scroll-y":"",class:"property-list",onScrolltolower:I},{default:s((()=>[j.value&&0===A.value.length?(u(),t(w,{key:0,class:"loading-placeholder"},{default:s((()=>[c("加载中...")])),_:1})):0===A.value.length?(u(),t(w,{key:1,class:"empty-placeholder"},{default:s((()=>[c("暂无房源")])),_:1})):(u(),t(w,{key:2},{default:s((()=>[(u(!0),v(f,null,_(A.value,(e=>(u(),t(w,{key:e.id,class:"property-item",onClick:a=>{return l=e.id,void k({url:`/pages/tenant/property-detail?id=${l}`});var l}},{default:s((()=>{var a;return[i(x,{class:"property-image",src:(null==(a=e.images)?void 0:a[0])||"/static/default-property.png",mode:"aspectFill"},null,8,["src"]),i(w,{class:"property-info"},{default:s((()=>[i(w,{class:"property-title"},{default:s((()=>[c(g(e.title),1)])),_:2},1024),i(w,{class:"property-details"},{default:s((()=>[c(g(e.district)+" | "+g(e.bedrooms)+"室 | "+g(e.area_sqm)+"㎡",1)])),_:2},1024),i(w,{class:"property-price"},{default:s((()=>[c("￥"+g(e.price_per_month)+"/月",1)])),_:2},1024),i(w,{class:"property-tags"},{default:s((()=>{var a;return[(u(!0),v(f,null,_(null==(a=e.amenities)?void 0:a.slice(0,3),(e=>(u(),t(S,{key:e,class:"tag"},{default:s((()=>[c(g(e),1)])),_:2},1024)))),128))]})),_:2},1024)])),_:2},1024)]})),_:2},1032,["onClick"])))),128)),C.value?(u(),t(w,{key:0,class:"loading-more"},{default:s((()=>[c("加载中...")])),_:1})):y("",!0),q.value?y("",!0):(u(),t(w,{key:1,class:"no-more"},{default:s((()=>[c("没有更多了")])),_:1}))])),_:1}))])),_:1})])),_:1})}}}),[["__scopeId","data-v-5e331135"]]);export{j as default};
